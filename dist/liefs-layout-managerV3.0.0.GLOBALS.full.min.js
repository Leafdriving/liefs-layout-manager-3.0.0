var _x_,_y_,_width_,_height_,_htmlBlock_,_displaygroup_,__classPrivateFieldGet=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},__classPrivateFieldSet=this&&this.__classPrivateFieldSet||function(e,t,i){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,i),i};class BaseF{static ifObjectMergeWithDefaults(t,i){if("object"in t.retArgs){let e=i.defaults;for(var s in t.retArgs.object)e=BaseF.mergeObjects(e,t.retArgs.object[s]);return e}return i.defaults}static retArgsMapped(e,t,i){let s={},l;for(var r in e)s[r]=e[r];for(var a in t.retArgs)if(a in i.argMap)for(l=0;l<t.retArgs[a].length&&l<i.argMap[a].length;)s[i.argMap[a][l]]=t.retArgs[a][l],l++;return s}static argumentsByType(e,t=[]){t=t.concat(Base.defaultIsChecks);let i={},s;var l;for(l of e){s=typeof l;for(var r of t)(r=r(l))&&(s=r);s in i||(i[s]=[]),i[s].push(l)}return i}static modifyClassProperties(e,t){for(var i of Object.keys(e))t[i]=e[i]}}BaseF.mergeObjects=function(e,t){let i={};for(var s in e)i[s]=e[s];for(var l in t)i[l]=t[l];return i};class Base{constructor(){}static byLabel(e){var t,i=this;for(t in i.instances)if(i.instances[t].label==e)return i.instances[t]}static pop(e=void 0){var t=this;null==(e=t.stringOrObject(e))&&(e=t.instances[t.instances.length-1]),t.deactivate(e);e=t.instances.indexOf(e);-1!=e&&t.instances.splice(e,1)}static push(e,t=!1){var i=this;e=i.stringOrObject(e),i.pop(e),i.instances.push(e),t&&i.activate(e)}static deactivate(e){var t=this;e=t.stringOrObject(e);e=t.activeInstances.indexOf(e);-1!=e&&t.activeInstances.splice(e,1)}static activate(e){var t=this;e=t.stringOrObject(e),t.deactivate(e),t.activeInstances.push(e)}static stringOrObject(e){return e="string"==typeof e?this.byLabel(e):e}buildBase(...e){this.constructor.buildBase(this,...e)}static buildBase(e,...t){var i=this;null==i.labelNo&&(i.labelNo=0),null==i.defaults&&(i.defaults={}),null==i.argMap&&(i.argMap={}),null==i.instances&&(i.instances=[]),null==i.activeInstances&&(i.activeInstances=[]),i.push(e),e.retArgs=BaseF.argumentsByType(t);t=BaseF.ifObjectMergeWithDefaults(e,i),i=BaseF.retArgsMapped(t,e,i);BaseF.modifyClassProperties(i,e)}static makeLabel(e){null!=e.label&&""!=e.label.trim()||(this.labelNo+=1,e.label=`${this.name}_${this.labelNo}`)}}class FunctionStack{static push(e,t){e in FunctionStack.instanceObj||(FunctionStack.instanceObj[e]=[]),FunctionStack.instanceObj[e].push(t)}static function(e){return function(...t){let i=FunctionStack.instanceObj[e];if(i)for(let e=0;e<i.length;e++)i[e](...t)}}static pop(e){FunctionStack.instanceObj[e]=[]}}FunctionStack.instanceObj={};class mf{static modifyClassProperties(e,t){for(var i of Object.keys(e))"function"==typeof e[i]&&"label"==i?t[i]=e[i]():t[i]=e[i]}static applyArguments(e,t,i,s,l,r=[]){r=pf.sortArgs(t,e,r),i=pf.ifObjectMergeWithDefaults(r,i),s=pf.retArgsMapped(r,i,s);mf.modifyClassProperties(s,l)}}class pf{static errorHandling(e){console.log(`Error Handeling Called\n${e}`)}static commonKeys(e,t){let i=[];for(var s in e)s in t&&i.push(s);return i}static retArgsMapped(e,t,i){let s={};var l,r;let a;for(l in t)s[l]=t[l];for(r in e)if(r in i)for(a=0;a<e[r].length&&a<i[r].length;)s[i[r][a]]=e[r][a],a++;return s}static ifObjectMergeWithDefaults(t,i){if("object"in t){let e=i;for(var s in t.object)e=pf.mergeObjects(e,t.object[s]);return e}return i}static sortArgs(e,t=0,i=[]){i=i.concat(pf.defaultIsChecks);let s={},l;var r;for(r of e){l=typeof r;for(var a of i)(a=a(r))&&(l=a);l in s||(s[l]=[]),s[l].push(r)}return s}static setAttrib(t,i,s){if(t.getAttribute(i)!=s){let e=document.createAttribute(i);e.value=s,t.setAttributeNode(e)}}static getAttribs(t,i={}){for(let e=0;e<t.attributes.length;e++)i[t.attributes[e].name]=t.attributes[e].value;return i}static elExists(e){return document.getElementById(e)}static viewport(){return[window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight]}static errorReporting(e){console.log("Error Reporting"),console.log(e)}static uis0(e){return null==e?0:e}static parseURLParams(e=window.location.href){let t=e.indexOf("?")+1,i=e.indexOf("#")+1||e.length+1,s=e.slice(t,i-1),l=s.replace(/\+/g," ").split("&"),r={},a,n,o,h;if(s!==e&&""!==s){for(a=0;a<l.length;a++)h=l[a].split("=",2),n=decodeURIComponent(h[0]),o=decodeURIComponent(h[1]),r.hasOwnProperty(n)||(r[n]=[]),r[n].push(2===h.length?o:null);return r}}}pf.isTypePx=function(e){return"string"==typeof e&&"px"==e.substr(-2)},pf.pxAsNumber=function(e){return+e.slice(0,-2)},pf.isTypePercent=function(e){return"string"==typeof e&&"%"==e.substr(-1)},pf.percentAsNumber=function(e){return+e.slice(0,-1)},pf.isDim=function(e){if("string"==typeof e&&("px"==e.substr(-2)||"%"==e.substr(-1)))return"dim"},pf.isArray=function(e){if("object"==typeof e&&Array.isArray(e))return"Array"},pf.isObjectAClass=function(e){if("object"==typeof e&&"Object"!=e.constructor.name)return e.constructor.name},pf.defaultIsChecks=[pf.isArray,pf.isObjectAClass,pf.isDim],pf.classProperties=function(e){return Object.getOwnPropertyNames(e)},pf.pad_with_zeroes=function(e,t=3){let i=""+e;for(;i.length<t;)i="0"+i;return i},pf.mergeObjects=function(e,t){let i={};for(var s in e)i[s]=e[s];for(var l in t)i[l]=t[l];return i},Base.defaultIsChecks=[pf.isArray,pf.isObjectAClass,pf.isDim];class Point{}class Within{constructor(...e){mf.applyArguments("Within",e,{},{number:["x","y","width","height"]},this)}clipStyleString(e){return Coord.clipStyleString(this,e)}reset(){this.x=this.y=this.width=this.height=void 0}}class Coord extends Base{constructor(...e){super(),_x_.set(this,void 0),_y_.set(this,void 0),_width_.set(this,void 0),_height_.set(this,void 0),this.within=new Within,this.buildBase(...e),Coord.makeLabel(this)}get x(){return __classPrivateFieldGet(this,_x_)+(this.offset?this.offset.x:0)}set x(e){__classPrivateFieldSet(this,_x_,e)}get y(){return __classPrivateFieldGet(this,_y_)+(this.offset?this.offset.y:0)}set y(e){__classPrivateFieldSet(this,_y_,e)}get width(){return __classPrivateFieldGet(this,_width_)+(this.offset?this.offset.width:0)}set width(e){__classPrivateFieldSet(this,_width_,e)}get height(){return __classPrivateFieldGet(this,_height_)+(this.offset?this.offset.height:0)}set height(e){__classPrivateFieldSet(this,_height_,e)}setOffset(e=0,t=0,i=0,s=0){this.offset=0==e&&0==t&&0==i&&0==s?void 0:{x:e,y:t,width:i,height:s}}cropWithin(e=this.within){var t=this.x,i=this.y,s=t+this.width,l=i+this.height,r=e.x,a=e.y,n=r+e.width,e=a+e.height,r=r<t?t:r,n=s<n?s:n,a=a<i?i:a,e=l<e?l:e;this.within.x=r,this.within.width=n-r,this.within.y=a,this.within.height=e-a}applyMargins(e,t,i,s){this.x+=e,this.within.x+=e,this.y+=t,this.within.y+=t,this.width-=e+i,this.within.width-=e+i,this.height-=t+s,this.within.height-=t+s}assign(e=void 0,t=void 0,i=void 0,s=void 0,l=void 0,r=void 0,a=void 0,n=void 0,o=void 0){null!=e&&(this.x=e),null!=t&&(this.y=t),null!=i&&(this.width=i),null!=s&&(this.height=s),null!=l&&(this.within.x=l),null!=r&&(this.within.y=r),null!=a&&(this.within.width=a),null!=n&&(this.within.height=n),null!=o&&(this.zindex=o)}copy(e){this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this.zindex=e.zindex,this.within.x=e.within.x,this.within.y=e.within.y,this.within.width=e.within.width,this.within.height=e.within.height}isCoordCompletelyOutside(e=this.within){return e.x+e.width<this.x||e.x>this.x+this.width||e.y+e.height<this.y||e.y>this.y+this.height}derender(e){return e||this.isCoordCompletelyOutside()}clipStyleString(e){return Coord.clipStyleString(this,e)}newClipStyleString(e=this.within){return Coord.clipStyleString(e,this)}static clipStyleString(t,i){let e="";var s=i.x<t.x?t.x-i.x:0;let l;if(i.hideWidth){let e=document.getElementById(i.label);var r=e.getBoundingClientRect();l=i.x+r.width>t.x+t.width?i.x+r.width-(t.x+t.width):0}else l=i.x+i.width>t.x+t.width?i.x+i.width-(t.x+t.width):0;r=i.y<t.y?t.y-i.y:0,t=i.y+i.height>t.y+t.height?i.y+i.height-(t.y+t.height):0;return 0<s+l+r+t&&(e=`clip-path: inset(${r}px ${l}px ${t}px ${s}px);`),e}isPointIn(e,t){return this.x<=e&&e<=this.x+this.width&&this.y<=t&&t<=this.y+this.height}asAttributeString(){return`left: ${this.x}px; top:${this.y}px; width:${this.width}px; height:${this.height}px; `+`z-index:${this.zindex};`}newAsAttributeString(){return`left: ${this.x}px; top:${this.y}px;`+`${this.hideWidth?"":"width:"+this.width+"px; "}`+`height:${this.height}px; z-index:${this.zindex+(Handler.activeOffset?3*Handler.zindexIncrement:0)};${this.newClipStyleString()}`}}_x_=new WeakMap,_y_=new WeakMap,_width_=new WeakMap,_height_=new WeakMap,Coord.instances=[],Coord.activeInstances=[],Coord.defaults={x:0,y:0,width:0,height:0,zindex:0},Coord.argMap={string:["label"],number:["x","y","width","height","zindex"],boolean:["hideWidth"]},Coord.CopyArgMap={Within:["Within"],Coord:["Coord"],boolean:["isRoot"],number:["x","y","width","height","zindex"]};class HtmlBlock extends Base{constructor(...e){super(),this.attributes={},this.buildBase(...e);let t=document.getElementById(this.label);if(t&&(this.innerHTML=t.innerHTML,this.attributes=pf.getAttribs(t,this.attributes),t.remove()),"Css"in this.retArgs)for(var i of this.retArgs.Css)this.css=(this.css+" "+i.classname).trim();"string"in this.retArgs&&3<this.retArgs.string.length&&(this.css+=" "+this.retArgs.string.splice(3).join(" ")),"number"in this.retArgs&&(1==(e=this.retArgs.number.length)?this.marginRight=this.marginTop=this.marginBottom=this.marginLeft:2==e&&(this.marginRight=this.marginLeft,this.marginBottom=this.marginTop)),HtmlBlock.makeLabel(this)}}function html(...e){let t=new HtmlBlock("",...e);return t.label=HtmlBlock.defaults.label(),t}HtmlBlock.instances=[],HtmlBlock.activeInstances=[],HtmlBlock.defaults={innerHTML:" ",tag:"DIV",css:"",dim:""},HtmlBlock.argMap={string:["label","innerHTML","css"],dim:["dim"],Events:["events"],number:["marginLeft","marginTop","marginRight","marginBottom"],boolean:["hideWidth"]};class Events extends Base{constructor(...e){super();let t=BaseF.argumentsByType(e);"object"in t&&(this.actions=t.object[0],delete t.object),this.buildBase(...e),Events.makeLabel(this)}applyToHtmlBlock(e){let t=e.el;for(var i in this.label=e.label,this.actions){var s;"onhold"==i?new Hold(t,this.actions[i]):"ondrag"==i?new Drag(t,this.actions[i]):(s=this.actions[i],Events.history.push(`document.getElementById("${e.label}").${i} = ${s}`),t[i]=s)}}static do(e){console.log(e),console.log(this)}}function events(...e){return new Events(...e)}Events.elementId="llmEvents",Events.instances=[],Events.activeInstances=[],Events.history=[],Events.defaults={},Events.argMap={string:["label"]};class DisplayCell extends Base{constructor(...e){super(),_htmlBlock_.set(this,void 0),_displaygroup_.set(this,void 0),this.overlays=[],this.isRendered=!1,this.buildBase(...e),this.displaygroup&&this.displaygroup.htmlBlock&&(this.htmlBlock=this.displaygroup.htmlBlock),this.htmlBlock&&(this.label=`${this.htmlBlock.label}`),this.label||(this.label=this.htmlBlock?this.htmlBlock.label+"_DisplayCell":this.displaygroup?this.displaygroup.label+"_DisplayCell":this.pages?this.pages.label+"_DisplayCell":void 0),this.htmlBlock&&this.htmlBlock.hideWidth?this.coord=new Coord(this.label,!0):this.coord=new Coord(this.label),DisplayCell.makeLabel(this)}get htmlBlock(){return __classPrivateFieldGet(this,_htmlBlock_)}set htmlBlock(e){__classPrivateFieldSet(this,_htmlBlock_,e),__classPrivateFieldGet(this,_htmlBlock_).dim&&(this.dim=__classPrivateFieldGet(this,_htmlBlock_).dim),__classPrivateFieldGet(this,_htmlBlock_).minDisplayGroupSize&&(this.minDisplayGroupSize=__classPrivateFieldGet(this,_htmlBlock_).minDisplayGroupSize)}get displaygroup(){return __classPrivateFieldGet(this,_displaygroup_)}set displaygroup(e){__classPrivateFieldSet(this,_displaygroup_,e),__classPrivateFieldGet(this,_displaygroup_).dim&&(this.dim=__classPrivateFieldGet(this,_displaygroup_).dim)}get minDisplayGroupSize(){return this.minDisplayGroupSize_||DisplayCell.minDisplayGroupSize}set minDisplayGroupSize(e){this.minDisplayGroupSize=e}addOverlay(e){this.overlays.push(e)}hMenuBar(e){(e.launchcell=this).htmlBlock.events=events({onmouseover:hMenuBar(e)})}vMenuBar(e){(e.launchcell=this).htmlBlock.events=events({onmouseover:vMenuBar(e)})}static concatArray(e,t){for(var i of t)e.push(i)}}function I(...e){return new DisplayCell(new HtmlBlock(...e))}_htmlBlock_=new WeakMap,_displaygroup_=new WeakMap,DisplayCell.instances=[],DisplayCell.activeInstances=[],DisplayCell.minDisplayGroupSize=200,DisplayCell.defaults={dim:""},DisplayCell.argMap={string:["label"],HtmlBlock:["htmlBlock"],DisplayGroup:["displaygroup"],dim:["dim"],Pages:["pages"],function:["preRenderCallback","postRenderCallback"]};class DisplayGroup extends Base{constructor(...e){super(),this.cellArray=[],this.htmlBlock=void 0,this.overlay=void 0,this.buildBase(...e),"DisplayCell"in this.retArgs&&(this.cellArray=this.retArgs.DisplayCell),"HtmlBlock"in this.retArgs&&(this.htmlBlock=this.retArgs.HtmlBlock[0]),"Array"in this.retArgs&&(this.cellArray=this.retArgs.Array[0]),"number"in this.retArgs&&1==this.retArgs.number.length&&(this.marginVer=this.marginHor=this.retArgs.number[0]),this.coord=new Coord(this.label);let t=0,i=0;for(var s of this.cellArray){s=s.dim;""==s?i++:pf.isTypePercent(s)&&(t+=pf.percentAsNumber(s))}e=100-t;if(i){var l,r=String(e/i)+"%";for(l of this.cellArray)""==l.dim&&(l.dim=r)}DisplayGroup.makeLabel(this)}percentToPx(e){var i,s=pf.percentAsNumber(e.dim),l=100-s;e.dim=`${this.ishor?e.coord.width:e.coord.height}px`;for(let t=0;t<this.cellArray.length;t++){let e=this.cellArray[t];pf.isTypePercent(e.dim)&&(i=pf.percentAsNumber(e.dim),i+=i/l*s,e.dim=`${i}%`)}}totalPx(e=!1){var t;let i=0;for(t of this.cellArray)t.pages&&!t.dim&&(t.dim=t.pages.evalCell().dim),pf.isTypePx(t.dim)?i+=pf.pxAsNumber(t.dim):e&&(i+=t.minDisplayGroupSize);return i}}function h(...e){return new DisplayCell(new DisplayGroup(...e))}function v(...e){return new DisplayCell(new DisplayGroup(!1,...e))}DisplayGroup.defaultMargins=0,DisplayGroup.instances=[],DisplayGroup.activeInstances=[],DisplayGroup.defaults={ishor:!0,marginHor:DisplayGroup.defaultMargins,marginVer:DisplayGroup.defaultMargins},DisplayGroup.argMap={string:["label"],boolean:["ishor"],number:["marginHor","marginVer"],dim:["dim"],Overlay:["overlay"]},DisplayGroup.argCustomTypes=[];class Handler extends Base{constructor(...e){if(super(),this.rootCell=void 0,this.buildBase(...e),Handler.updateScreenSize(),"DisplayCell"in this.retArgs?this.rootCell=this.retArgs.DisplayCell[0]:pf.errorHandling(`Handler "${this.label}" requires a DisplayCell`),null==this.handlerMargin&&(this.handlerMargin=Handler.handlerMarginDefault),Handler.firstRun){setTimeout(Handler.update),Handler.firstRun=!1;for(var t of document.querySelectorAll(Css.deleteOnFirstRunClassname))t.remove();window.onresize=function(){Handler.update()},window.onwheel=function(e){ScrollBar.onWheel(e)},window.addEventListener("popstate",function(e){Pages.popstate(e)}),Pages.parseURL()}this.addThisHandlerToStack&&Handler.activeInstances.push(this),Handler.makeLabel(this),Handler.update(),Css.update()}pop(){return Handler.pop(this)}toTop(){var e=Handler.activeInstances.indexOf(this);-1<e&&e!=Handler.activeInstances.length-1&&(Handler.activeInstances.splice(e,1),Handler.activeInstances.push(this),Handler.update())}static pop(e=Handler.activeInstances[Handler.activeInstances.length-1]){var t=Handler.activeInstances.indexOf(e);let i=void 0;return-1!=t&&(i=Handler.activeInstances[t],Handler.update([e],t,!0),Handler.activeInstances.splice(t,1)),i}static screensizeToCoord(e,t){var i=pf.viewport();e.coord.assign(t,t,i[0]-2*t,i[1]-2*t,t,t,i[0]-2*t,i[1]-2*t,Handler.currentZindex)}static updateScreenSize(){var[e,t]=pf.viewport();Handler.screenSizeCoord.assign(0,0,e,t,0,0,e,t,0)}static update(i=Handler.activeInstances,s=0,l=!1){Handler.updateScreenSize(),Handler.renderAgain=!1,Pages.activePages=[],Handler.currentZindex=Handler.handlerZindexStart+Handler.handlerZindexIncrement*s;for(let t=0;t<i.length;t++){let e=i[t];e.preRenderCallback&&e.preRenderCallback(e),e.coord?e.rootCell.coord.copy(e.coord):Handler.screensizeToCoord(e.rootCell,e.handlerMargin),Handler.renderDisplayCell(e.rootCell,void 0,void 0,l),s+=1,Handler.currentZindex=Handler.handlerZindexStart+Handler.handlerZindexIncrement*s,e.postRenderCallback&&e.postRenderCallback(e)}Pages.activePages.length&&Pages.applyOnclick(),Observe.update(),Handler.renderAgain&&console.log("REDNDER AGAIN!")}static renderDisplayCell(t,i,e,s){t.coord.offset&&(Handler.activeOffset=!0),t.preRenderCallback&&t.preRenderCallback(t,i,e,s),s&&Observe.derender(t);let l=t.pages;if(l){s||Pages.activePages.push(l);var r=l.eval();r!=l.previousPage&&(l.displaycells[l.previousPage].coord.copy(t.coord),Handler.renderDisplayCell(l.displaycells[l.previousPage],i,e,!0),l.currentPage=l.previousPage=r,Pages.pushHistory()),l.displaycells[r].coord.copy(t.coord),Handler.renderDisplayCell(l.displaycells[r],i,e,s),l.currentPage=r,l.addSelected()}else{r=t.htmlBlock;let e=t.displaygroup;r&&Handler.renderHtmlBlock(t,s,i),e&&(e.coord.copy(t.coord),e&&r&&(Handler.currentZindex+=Handler.zindexIncrement,t.coord.applyMargins(pf.uis0(r.marginLeft),pf.uis0(r.marginTop),pf.uis0(r.marginRight),pf.uis0(r.marginBottom))),Handler.renderDisplayGroup(t,s))}if(t.overlays.length)for(var a of t.overlays)a.renderOverlay(t,i,e,s);t.postRenderCallback&&t.postRenderCallback(t,i,e,s),t.coord.offset&&(Handler.activeOffset=!1)}static renderDisplayGroup(t,i){let s=t.displaygroup;var l=s.ishor,r=s.coord,a=s.cellArray.length,n=l?s.marginHor*(a-1):s.marginVer*(a-1),o=l?r.width-n:r.height-n,h=s.totalPx(),c=o-h;let d=0;var p;let u,g=c;var f,y,n=s.overlay;let b=[];for(let e=0;e<a;e++){var v=s.cellArray[e],m=v.dim,w=pf.isTypePx(v.dim)?pf.pxAsNumber(v.dim):v.minDisplayGroupSize,v=pf.isTypePx(v.dim)?pf.pxAsNumber(v.dim):pf.percentAsNumber(v.dim)*c/100;b.push({dim:m,min:w,px:v})}let x,C;do{x=!1;let i=0;for(let t=C=0;t<b.length;t++){let e=b[t];e.px<e.min&&(e.px=e.min,e.dim=`${e.px}px`,x=!0),i+=pf.isTypePx(e.dim)?e.px:0,C+=e.px}var k=o-i;if(x){let t=0;for(let e=0;e<b.length;e++){var D=b[e];pf.isTypePercent(D.dim)&&(t+=pf.percentAsNumber(D.dim))}var H=100/t;for(let t=C=0;t<b.length;t++){let e=b[t];pf.isTypePercent(e.dim)&&(e.dim=`${pf.percentAsNumber(e.dim)*H}%`,e.px=pf.percentAsNumber(e.dim)*k/100),C+=e.px}}}while(x);if(c<0){n||(s.overlay=new Overlay("ScrollBar",`${s.label}_ScrollBar`,s,h,o)),s.overlay.renderOverlay(t,s,0,!1);let e=s.coord;h=s.overlay.returnObj.scrollWidth;e.width-=l?0:h,e.within.width-=l?0:h,e.height-=l?h:0,e.within.height-=l?h:0}else n&&n.currentlyRendered&&s.overlay.renderOverlay(t,s,0,!0);let B=s.coord.x,T=s.coord.y;s.overlay&&(s.offset=s.overlay.returnObj.offset,B-=l?s.offset:0,T-=l?0:s.offset);for(let t=0;t<a;t++){let e=s.cellArray[t];pf.isTypePercent(e.dim)&&(p=pf.percentAsNumber(e.dim),d+=p,d<=100.01?(u=Math.round(c*p/100),g-=u):u=g),y=pf.isTypePx(e.dim)?pf.pxAsNumber(e.dim):u,f=l?y:r.width,y=l?r.height:y,e.coord.assign(B,T,f,y,void 0,void 0,void 0,void 0,Handler.currentZindex),e.coord.cropWithin(s.coord.within),Handler.renderDisplayCell(e,s,t,i),B+=l?f+s.marginHor:0,T+=l?0:y+s.marginVer}}static renderHtmlBlock(e,t=!1,i){let s=e.htmlBlock,l=pf.elExists(e.label);var r=!!l;t=e.coord.derender(t);var a=""==s.css.trim()&&""==s.innerHTML.trim()&&0==Object.keys(s.attributes).length&&!Handler.renderNullObjects;t||a?r&&l.remove():(r||(l=document.createElement(s.tag)),pf.setAttrib(l,"id",e.label),s.css.trim()&&pf.setAttrib(l,"class",s.css),Handler.renderHtmlAttributes(l,s,e.label),l.innerHTML!=s.innerHTML&&(l.innerHTML=s.innerHTML),r||(document.body.appendChild(l),s.el=l,s.events&&s.events.applyToHtmlBlock(s)),e=e.coord.newAsAttributeString(),l.style.cssText!=e&&(l.style.cssText=e))}static renderHtmlAttributes(t,i,s){for(var l in i.attributes){let e=i.attributes[l];"class"==l&&(e+=" "+i.css),"id"==l&&(e=s),pf.setAttrib(t,l,e)}pf.setAttrib(t,"llm","")}}function H(...e){return new Handler(...e)}Handler.handlerMarginDefault=0,Handler.firstRun=!0,Handler.instances=[],Handler.activeInstances=[],Handler.defaults={cssString:" ",addThisHandlerToStack:!0,controlledBySomething:!1,activeOffset:!1},Handler.argMap={string:["label"],number:["handlerMargin"],Coord:["coord"],function:["preRenderCallback","postRenderCallback"],boolean:["addThisHandlerToStack"]},Handler.screenSizeCoord=new Coord,Handler.renderNullObjects=!1,Handler.argCustomTypes=[],Handler.handlerZindexStart=1,Handler.zindexIncrement=1,Handler.handlerZindexIncrement=100;class Css extends Base{constructor(...e){super(),this.buildBase(...e),null==this.cssObj&&(this.cssObj=this.makeObj(),this.css=this.makeString()),this.cssHover&&(this.cssHoverObj=this.makeObj(this.cssHover),this.cssHover=this.makeString(this.cssHoverObj,"hover")),this.cssSelect&&(this.cssSelectObj=this.makeObj(this.cssSelect),this.cssSelect=this.makeString(this.cssSelectObj,"","Selected"))}static byLabel(e){for(var t in Css.instances)if(Css.instances[t].classname==e)return Css.instances[t]}makeString(e=this.cssObj,t="",i=""){let s=`${this.isClassname?".":""}${this.classname}${i}${t?":"+t:""} {\n`;for(var l in e)s+=`  ${l}:${e[l]};\n`;return s+="}",s}makeObj(e=this.css){let t={};var i;let s;for(i of(e=-1<e.indexOf("{")?(e=e.split("{")[1]).split("}")[0]:e).split(";"))-1<i.indexOf(":")&&(s=i.split(":"),t[s[0].trim()]=s[1].trim());return t}static byname(e){for(var t of Css.instances)if(t.css==e)return t}static update(){let e=document.getElementById(Css.elementId),t=!0;e||(t=!1,e=document.createElement("style")),pf.setAttrib(e,"id",Css.elementId);let i="\n";for(var s of Css.instances)s.css&&(i+=s.css+"\n"),s.cssHover&&(i+=s.cssHover+"\n"),s.cssSelect&&(i+=s.cssSelect+"\n");e.innerHTML=i,t||document.getElementsByTagName("head")[0].appendChild(e)}}function css(...e){return new Css(...e)}Css.elementId="llmStyle",Css.instances=[],Css.activeInstances=[],Css.defaults={css:function(){return`Css_${pf.pad_with_zeroes(Css.instances.length)}`},isClassname:!0},Css.argMap={string:["classname","css","cssHover","cssSelect","cssSelectHover"],boolean:["isClassname"]},Css.deleteOnFirstRunClassname=".remove";class DefaultTheme{}DefaultTheme.advisedDiv=new Css("div[llm]","position:absolute;",!1),DefaultTheme.advisedBody=new Css("body","overflow: hidden;",!1),DefaultTheme.context=css("contxt","background-color:white;color: black;outline-style: solid;outline-width: 1px;","contxt:hover","background-color:black;color: white;outline-style: solid;outline-width: 1px;"),Css.theme=DefaultTheme;class Pages extends Base{constructor(...e){super(),this.buildBase(...e),Pages.pop(this),Pages.instances.unshift(this),this.retArgs.DisplayCell?this.displaycells=this.retArgs.DisplayCell:pf.errorHandling("Pages Requires at least one DisplayCells"),Pages.makeLabel(this)}eval(){return this.evalFunction(this)}evalCell(){return this.displaycells[this.eval()]}setPage(e){e!=this.currentPage&&(this.currentPage=e,Handler.update())}addSelected(e=this.currentPage){var t,i=document.querySelectorAll(`[pagebutton='${this.label}|${e}']`);let s;for(let e=0;e<i.length;e++)s=i[e],(t=s.getAttribute("select"))?pf.setAttrib(s,"class",t):(t=s.getAttribute("class"),Css.byLabel(t).cssSelect&&pf.setAttrib(s,"class",t+"Selected"))}static setPage(e,t){Pages.byLabel(e).setPage(t)}static applyOnclick(){var t=document.querySelectorAll("[pagebutton]");let i;for(let e=0;e<t.length;e++)i=t[e],i.onclick=function(e){Tree.onclick.bind(this)(e)}}indexByName(t){for(let e=0;e<this.displaycells.length;e++)if(this.displaycells[e].label==t)return e;return-1}static button(e,t){return{attributes:{pagebutton:`${e}|${t}`}}}static parseURL(e=window.location.href){var t=pf.parseURLParams(e);if(t)for(var i in t){let e=Pages.byLabel(i);e&&(e.currentPage=t[i])}}static pushHistory(){let e=window.location.href.split("?")[0],t="?";for(const i of Pages.activePages)i.currentPage&&(e+=`${t}${i.label}=${i.currentPage}`,t="&");history.pushState(null,null,e)}static popstate(e){for(let e=0;e<Pages.activePages.length;e++){const t=Pages.activePages[e];t.currentPage=0}Pages.parseURL(),Handler.update()}}function P(...e){let t=new DisplayCell(new Pages(...e));return t.pages.dim&&(t.dim=t.pages.dim),t}Pages.activePages=[],Pages.instances=[],Pages.activeInstances=[],Pages.defaults={currentPage:0,previousPage:0,evalFunction:function(e){return e.currentPage}},Pages.argMap={string:["label"],number:["currentPage"],function:["evalFunction"],dim:["dim"]};class Drag extends Base{constructor(...e){super(),this.onDown=function(){},this.onMove=function(){},this.onUp=function(){},this.isDown=!1,this.buildBase(...e),"Array"in this.retArgs&&(e=this.retArgs.Array[0],this.onDown=e[0],this.onMove=e[1],this.onUp=e[2]),"HTMLDivElement"in this.retArgs&&(this.el=this.retArgs.HTMLDivElement[0]);let t=this;this.el.onmousedown=function(e){t.onDown(),t.isDown=!0,t.mousePos={x:e.clientX,y:e.clientY},window.addEventListener("selectstart",Drag.disableSelect),window.onmousemove=function(e){t.mouseDiff={x:e.clientX-t.mousePos.x,y:e.clientY-t.mousePos.y},t.onMove(t.mouseDiff)},window.onmouseup=function(e){t.reset(),t.onUp(t.mouseDiff)}},Drag.makeLabel(this)}reset(){window.onmousemove=function(){},window.onmouseup=function(){},window.removeEventListener("selectstart",Drag.disableSelect),this.isDown=!1}static disableSelect(e){e.preventDefault()}}Drag.instances=[],Drag.activeInstances=[],Drag.defaults={},Drag.argMap={string:["label"]};class Swipe extends Base{constructor(...e){super(),this.buildBase(...e),Swipe.makeLabel(this)}}function swipe(...e){let t=new Swipe(...e);return{onMove:function(e){t.left&&e.x<-t.swipeDistance&&(t.left(),this.reset()),t.right&&e.x>t.swipeDistance&&(t.right(),this.reset()),t.up&&e.y<-t.swipeDistance&&(t.up(),this.reset()),t.down&&e.y>t.swipeDistance&&(t.down(),this.reset())}}}Swipe.swipeDistance=50,Swipe.elementId="llmSwipe",Swipe.instances=[],Swipe.activeInstances=[],Swipe.defaults={swipeDistance:Swipe.swipeDistance},Swipe.argMap={string:["label"],number:["swipeDistance"]};class Hold extends Base{constructor(...e){super(),this.onDown=function(){},this.event=function(){},this.onUp=function(){},this.isDown=!1,this.buildBase(...e),"HTMLDivElement"in this.retArgs&&(this.el=this.retArgs.HTMLDivElement[0]);let t=this;this.el.onmousedown=function(e){t.onDown(),t.isDown=!0,t.doOnclick&&t.event(),setTimeout(function(){Hold.start(t)},t.startTime),window.onmouseup=function(e){t.onUp(),t.isDown=!1}},Hold.makeLabel(this)}static start(e){e.isDown&&(e.event(),setTimeout(function(){Hold.start(e)},e.repeatTime))}}Hold.instances=[],Hold.activeInstances=[],Hold.defaults={startTime:1e3,repeatTime:100,doOnclick:!0},Hold.argMap={string:["label"]};class Overlay{constructor(...e){Overlay.instances.push(this),this.label=`Overlay_${pf.pad_with_zeroes(Overlay.instances.length)}`,this.sourceClassName=e.shift(),this.returnObj=new Overlay.classes[this.sourceClassName](...e)}static byLabel(e){for(var t in Overlay.instances)if(Overlay.instances[t].label==e)return Overlay.instances[t]}renderOverlay(e,t,i,s){this.currentlyRendered=!s,this.returnObj.render(e,t,i,s)}}Overlay.instances=[],Overlay.classes={};class DragBar extends Base{constructor(...e){super(),this.buildBase(...e);let i=this;this.displaycell=I(`${this.label}_dragbar`,"",events({ondrag:{onDown:function(e){pf.isTypePercent(i.parentDisplaycell.dim)&&i.parentDisplaygroup.percentToPx(i.parentDisplaycell),i.startpos=pf.pxAsNumber(i.parentDisplaycell.dim)},onMove:function(e){let t=i.startpos+(i.ishor?e.x:e.y)*(i.isLast?-1:1);t>i.max&&(t=i.max),t<i.min&&(t=i.min),i.parentDisplaycell.dim=`${t}px`,Handler.update()}}})),DragBar.makeLabel(this)}render(e,t,i,s){this.parentDisplaygroup||(this.parentDisplaygroup=t);var l=this;let r=l.displaycell;var a=t.ishor;l.ishor=a;var n=l.pxsize||(a?t.marginHor:t.marginVer),o=i==t.cellArray.length-1;l.isLast=o;var h=e.coord,i=a?o?h.x-n:h.x+h.width:h.x,e=a?h.y:o?h.y-n:h.y+h.height,o=a?n:h.width,n=a?h.height:n;r.coord.assign(i,e,o,n,void 0,void 0,void 0,void 0,Handler.currentZindex+Handler.zindexIncrement),r.htmlBlock.css=(a?l.horcss:l.vercss).classname,t.coord.isCoordCompletelyOutside(r.coord)&&(s=!0),Handler.renderDisplayCell(r,t,void 0,s)}}function dragbar(...e){e=new Overlay("DragBar",...e);let t=e.returnObj.parentDisplaycell;return t.addOverlay(e),t}DragBar.horCss=css("db_hor","background-color:black;cursor: ew-resize;"),DragBar.verCss=css("db_ver","background-color:black;cursor: ns-resize;"),DragBar.instances=[],DragBar.activeInstances=[],DragBar.defaults={horcss:DragBar.horCss,vercss:DragBar.verCss},DragBar.argMap={string:["label"],DisplayCell:["parentDisplaycell"],number:["min","max","pxsize"],Css:["horcss","vercss"]},Overlay.classes.DragBar=DragBar;class ScrollBar extends Base{constructor(...e){super(),this.buildBase(...e),ScrollBar.makeLabel(this),this.build()}build(){let t=this;var e=this.arrowOffset,i=this.scrollWidth,s=i-e,l=i/2;this.leftArrow=I(this.label+"_Left",`<svg height="${i}" width="${i}">
            <polygon points="${e},${l} ${s},${e} ${s},${s} ${e},${l}"
            style="fill:black;stroke:black;stroke-width:1" />
            </svg>`,`${i}px`,"whiteBG",events({onhold:{event:function(e){t.clickLeftorUp(e)}}})),this.upArrow=I(this.label+"_Up",`<svg height="${i}" width="${i}">
            <polygon points="${e},${s} ${l},${e} ${s},${s} ${e},${s}"
            style="fill:black;stroke:black;stroke-width:1" />
            </svg>`,`${i}px`,"whiteBG",events({onhold:{event:function(e){t.clickLeftorUp(e)}}})),this.prePaddle=I(this.label+"_Pre","","whiteBG",events({onclick:function(e){t.clickPageLeftorUp(e)}})),this.paddle=I(this.label+"_Paddle","","blackBG",events({ondrag:{onDown:function(){t.offsetAtDrag=t.offset},onMove:function(e){t.dragging(e)}}})),this.postPaddle=I(this.label+"_Post","","whiteBG",events({onclick:function(e){t.clickPageRightOrDown(e)}})),this.rightArrow=I(this.label+"_Right",`<svg height="${i}" width="${i}">
            <polygon points="${e},${e} ${s},${l} ${e},${s} ${e},${e}"
            style="fill:black;stroke:black;stroke-width:1" />
            </svg>`,`${i}px`,"whiteBG",events({onhold:{event:function(e){t.clickRightOrDown(e)}}})),this.downArrow=I(this.label+"_down",`<svg height="${i}" width="${i}">
            <polygon points="${e},${e} ${s},${e} ${l},${s} ${e},${e}"
            style="fill:black;stroke:black;stroke-width:1" />
            </svg>`,`${i}px`,"whiteBG",events({onhold:{event:function(e){t.clickRightOrDown(e)}}})),this.ishor=this.displaygroup.ishor,this.displaycell=h(this.ishor,this.ishor?this.leftArrow:this.upArrow,this.prePaddle,this.paddle,this.postPaddle,this.ishor?this.rightArrow:this.downArrow,this.label)}clickLeftorUp(e,t=1){this.offset-=this.offsetPixelRatio*t,this.offset<0&&(this.offset=0),Handler.update()}clickRightOrDown(e,t=1){this.offset+=this.offsetPixelRatio*t,this.offset>this.maxOffset&&(this.offset=this.maxOffset),Handler.update()}clickPageLeftorUp(e){this.offset-=this.displayedFixedPx,this.offset<0&&(this.offset=0),Handler.update()}clickPageRightOrDown(e){this.offset+=this.displayedFixedPx,this.offset>this.maxOffset&&(this.offset=this.maxOffset),Handler.update()}dragging(e){e=this.ishor?e.x:e.y;let t=this.offsetAtDrag+e*this.offsetPixelRatio;t<0&&(t=0),t>this.maxOffset&&(t=this.maxOffset),this.offset=t,Handler.update()}render(e,t,i,s){this.parentDisplaygroup||(this.parentDisplaygroup=t);var l=this.displaygroup.coord,r=this.ishor?l.within.x:l.within.x+l.within.width-this.scrollWidth,a=this.ishor?l.within.width:this.scrollWidth,t=this.ishor?l.within.y+l.within.height-this.scrollWidth:l.within.y,l=this.ishor?this.scrollWidth:l.within.height;this.displaycell.coord.assign(r,t,a,l);let n=this.displaycell.displaygroup.cellArray[1],o=this.displaycell.displaygroup.cellArray[2],h=this.displaycell.displaygroup.cellArray[3];t=this.displaygroup.totalPx(),a=this.displayedFixedPx=this.ishor?a:l;this.maxOffset=t-a,this.offset>this.maxOffset&&(this.offset=this.maxOffset),this.offset<0&&(this.offset=0),this.offsetPixelRatio=t/a;l=Math.round(this.offset/t*100),a=Math.round(a/t*100),t=100-a-l;n.dim=`${l}%`,o.dim=`${a}%`,h.dim=`${t}%`,Handler.currentZindex+=2*Handler.zindexIncrement,this.currentlyRendered=!s,Handler.renderDisplayCell(this.displaycell,void 0,void 0,s),Handler.currentZindex-=2*Handler.zindexIncrement}static distOfMouseFromWheel(e,t){var i=e.displaygroup.ishor,s=e.displaycell.coord,e=t.clientX,t=t.clientY;let l=0;return i?(t<s.y&&(l=s.y-t),t>s.y+s.height&&(l=t-(s.y+s.height))):(e<s.x&&(l=s.x-e),e>s.x+s.width&&(l=e-(s.x+s.width))),l}static onWheel(e){let t,i=1e5;var s,l;for(l of ScrollBar.instances)l.currentlyRendered&&(l.parentDisplaygroup.coord.isPointIn(e.clientX,e.clientY)||l.displaycell.coord.isPointIn(e.clientX,e.clientY))&&(s=ScrollBar.distOfMouseFromWheel(l,e),(!t||s<i)&&(i=s,t=l));t&&(0<e.deltaY&&t.clickRightOrDown(e,ScrollBar.scrollWheelMult*e.deltaY/100),e.deltaY<0&&t.clickLeftorUp(e,-ScrollBar.scrollWheelMult*e.deltaY/100))}}ScrollBar.instances=[],ScrollBar.activeInstances=[],ScrollBar.whiteBG=css("whiteBG","background-color:white;outline: 1px solid black;outline-offset: -1px;"),ScrollBar.blackBG=css("blackBG","background-color:black;color:white;cursor: -webkit-grab; cursor: grab;"),ScrollBar.defaults={offset:0,displayAtEnd:!0,scrollWidth:15,currentlyRendered:!0,arrowOffset:2},ScrollBar.argMap={string:["label"],DisplayGroup:["displaygroup"],number:["fixedPixels","viewingPixels","scroolWidth"],boolean:["displayAtEnd"]},ScrollBar.scrollWheelMult=4,ScrollBar.triggerDistance=40,Overlay.classes.ScrollBar=ScrollBar;class Context extends Base{constructor(...e){super(),this.coord=new Coord,this.buildBase(...e),this.menuObj||(this.menuObj=Context.defaultObj),this.height=Object.keys(this.menuObj).length*this.cellheight,Context.makeLabel(this),this.buildCell()}buildCell(){let i=this,e=[];var s,l=Object.keys(this.menuObj).length;let r=0,a;for(s in this.displaycell=v({cellArray:[]}),this.menuObj){let t=this.menuObj[s];"function"==typeof t?e.push(I(r==l-1?"100%":`${this.cellheight}px`,{innerHTML:s},this.css,events({onclick:function(e){t(e),i.popAll()}}))):(a=new Context({menuObj:t,width:this.width,cellheight:this.cellheight,css:this.css,parentContext:this}),a.launchcell=I(r==l-1?"100%":`${this.cellheight}px`,{innerHTML:s},this.css,events({onmouseover:function(){var e=i.coord;a.handler||a.render(void 0,e.x+e.width-Context.subOverlapPx,e.y+i.cellheight*(r-2)-Context.subOverlapPx)}})),e.push(a.launchcell)),r+=1}this.displaycell.displaygroup.cellArray=e}popAll(){this.pop(),this.parentContext?this.parentContext.popAll():window.onmousemove=function(){}}pop(){this.handler.pop(),this.handler=void 0,this.parentContext&&(Context.lastRendered=this.parentContext)}managePop(e){var t=e.clientX,e=e.clientY;let i=!this.displaycell.coord.isPointIn(t,e);i&&this.launchcell&&this.launchcell.coord.isPointIn(t,e)&&(i=!1);let s=this;i&&(this.parentContext?window.onmousemove=function(e){s.parentContext.managePop(e)}:window.onmousemove=function(){},this.pop())}render(e,t=0,i=0){e&&(t=e.clientX-Context.subOverlapPx,i=e.clientY-Context.subOverlapPx),this.coord.assign(t,i,this.width,this.height),this.handler=H(this.displaycell,this.coord);let s=this;window.onmousemove=function(e){s.managePop(e)},Context.lastRendered=this}hMenuBarx(){return this.launchcell.coord.x}hMenuBary(){return this.launchcell.coord.y+this.launchcell.coord.height}vMenuBarx(){return this.launchcell.coord.x+this.launchcell.coord.width}vMenuBary(){return this.launchcell.coord.y}}Context.subOverlapPx=4,Context.instances=[],Context.activeInstances=[],Context.defaultMenuBarCss=css("menuBar","background-color:white;color: black;"),Context.defaultMenuBarHover=css("menuBar:hover","background-color:black;color: white;"),Context.defaultMenuBarNoHoverCss=css("menuBarNoHover","background-color:white;color: black;"),Context.defaultObj={one:function(){console.log("one")},two:function(){console.log("two")},three:function(){console.log("three")}},Context.defaults={width:100,cellheight:25,css:Css.theme.context},Context.argMap={string:["label"],number:["width","cellheight"]};let context=function(...e){let t=new Context(...e);return function(e){return t.render(e),!1}},hMenuBar=function(...e){let t=new Context(...e);return function(e){return Context.lastRendered&&Context.lastRendered.handler&&Context.lastRendered.popAll(),t.render(void 0,t.hMenuBarx(),t.hMenuBary()),!1}},vMenuBar=function(...e){let t=new Context(...e);return function(e){return t.render(void 0,t.vMenuBarx(),t.vMenuBary()),!1}};class Modal extends Base{constructor(...e){var t;super(),this.buildBase(...e),"number"in this.retArgs&&this.setSize(...this.retArgs.number),this.coord||([t,e]=pf.viewport(),this.coord=new Coord(Math.round(t/4),Math.round(e/4),Math.round(t/2),Math.round(e/2)),this.coord.within.x=this.coord.within.y=0,this.coord.within.width=t,this.coord.within.height=e),this.withinCoord||(this.withinCoord=Handler.activeInstances.length?Handler.activeInstances[0].rootCell.coord:Handler.screenSizeCoord),this.fullCell||(this.bodyCell||(this.bodyCell=I(this.label,this.innerHTML,Modal.bodyCss)),this.footerTitle&&(this.showFooter=!0),Modal.makeLabel(this),this.build()),this.handler=H(`${this.label}_h`,v(this.fullCell),this.coord,!1,this.preRenderCallback.bind(this))}setSize(...e){var t,i,[s,l]=pf.viewport(),r=e.length;2<=r&&r<4?(this.coord||(this.coord=new Coord),t=e[0],i=e[1],this.coord.assign((s-t)/2,(l-i)/2,t,i)):4<=r&&(this.coord||(this.coord=new Coord),this.coord.assign(e[0],e[1],e[2],e[3]),this.coord.within.x=this.coord.within.y=0,this.coord.within.width=s,this.coord.within.height=l)}setContent(e){this.bodyCell.htmlBlock.innerHTML=e,Handler.update()}setTitle(e){this.headerCell.displaygroup.cellArray[0].htmlBlock.innerHTML=e,Handler.update()}setFooter(e){this.footerCell.displaygroup.cellArray[0].htmlBlock.innerHTML=e,Handler.update()}buildClose(){let e=this;return I({innerHTML:`<svg viewPort="0 0 ${this.headerHeight} ${this.headerHeight}" version="1.1"
        xmlns="http://www.w3.org/2000/svg" style="width: ${this.headerHeight}px; height: ${this.headerHeight}px;">
        <line x1="3" y1="${this.headerHeight-3}" x2="${this.headerHeight-3}" y2="3" 
          stroke="black" stroke-width="2"/>
        <line x1="3" y1="3" x2="${this.headerHeight-3}" y2="${this.headerHeight-3}" 
          stroke="black" stroke-width="2"/></svg>`},Modal.closeCss,`${this.headerHeight}px`,events({onclick:function(){e.hide()}}))}buildHeader(){let t=this;this.headerCell||(this.headerCell=h(`${this.label}_header`,`${this.headerHeight}px`,I(`${this.label}_headerTitle`,this.headerTitle,Modal.headerCss,events({ondrag:{onDown:function(){return Modal.movingInstace=t,Modal.startMoveModal(t.handler)},onMove:function(e){return Modal.moveModal(t.handler,e)},onUp:function(e){Modal.movingInstace=void 0}}}))),this.showClose&&this.headerCell.displaygroup.cellArray.push(this.buildClose()))}buildFooter(){this.footerCell||(this.footerCell=h(`${this.label}_footer`,`${this.footerHeight}px`,I(`${this.label}_footerTitle`,this.footerTitle,Modal.footerCss)))}buildOptions(){let e=this;this.optionsCell||(this.optionsCell=h(`${this.label}_options`,`${this.optionsHeight}px`,I(`${this.label}_okButton`,"<button>OK</button>",Modal.optionsCss,events({onclick:function(){e.hide()}}))))}buildFull(){this.fullCell=v(this.bodyCell),this.showHeader&&this.fullCell.displaygroup.cellArray.unshift(this.headerCell),this.showOptions&&this.fullCell.displaygroup.cellArray.push(this.optionsCell),this.showFooter&&this.fullCell.displaygroup.cellArray.push(this.footerCell)}build(){this.buildHeader(),this.buildFooter(),this.buildOptions(),this.buildFull()}show(){Handler.activate(this.handler),Handler.update()}hide(){this.handler.pop()}preRenderCallback(e){var t=this.withinCoord.within,i=t.x,s=t.y,l=t.x+t.width,t=t.y+t.height;let r=e.coord;r.x+r.width>l&&(r.x=l-r.width),r.x<i&&(r.width+=r.x,r.x=i),r.y+r.height>t&&(r.y=t-r.height),r.y<s&&(r.height+=r.y,r.y=s)}static startMoveModal(e){e.toTop(),Modal.x=e.coord.x,Modal.y=e.coord.y}static moveModal(e,t){Modal.offset=t;var i=pf.viewport();let s=Modal.x+t.x;s<0&&(s=0),s+e.coord.width>i[0]&&(s=i[0]-e.coord.width),e.coord.x=s;let l=Modal.y+t.y;l<0&&(l=0),l+e.coord.height>i[1]&&(l=i[1]-e.coord.height),e.coord.y=l,Handler.update()}}Modal.instances=[],Modal.activeInstances=[],Modal.headerCss=css("HeaderTitle","background-color:blue;color:white;text-align: center;border: 1px solid black;cursor: -webkit-grab; cursor: grab;"),Modal.footerCss=css("FooterTitle","background-color:white;color:black;border: 1px solid black;"),Modal.closeCss=css("Close","background-color:white;color:black;border: 1px solid black;font-size: 20px;"),Modal.closeCssHover=css("Close:hover","background-color:red;color:white;border: 1px solid black;font-size: 20px;"),Modal.bodyCss=css("ModalBody","background-color:white;border: 1px solid black;"),Modal.optionsCss=css("ModalOptions","background-color:white;border: 1px solid black;display: flex;justify-content: center;align-items: center;"),Modal.defaults={showHeader:!0,showFooter:!1,resizeable:!0,showClose:!0,showOptions:!0,headerHeight:20,footerHeight:20,headerTitle:"",footerTitle:"",innerHTML:"",optionsHeight:30},Modal.argMap={string:["label","innerHTML","headerTitle","footerTitle"],DisplayCell:["bodyCell","optionsCell","footerCell","headerCell"],Coord:["coord","withinCoord"]};class Stretch extends Base{constructor(...e){super(),this.buildBase(...e),!this.parentDisplaycell&&this.parentModal&&(this.parentDisplaycell=this.parentModal.fullCell),this.UL=I(`${this.label}_UL`,Stretch.NWcss,this.events("UL")),this.UR=I(`${this.label}_UR`,Stretch.NEcss,this.events("UR")),this.LL=I(`${this.label}_LL`,Stretch.NEcss,this.events("LL")),this.LR=I(`${this.label}_LR`,Stretch.NWcss,this.events("LR")),Stretch.makeLabel(this)}events(i){let h=this;return events({ondrag:{onDown:function(e){var t=(h.parentModal?h.parentModal.handler:h.parentDisplaycell).coord;Stretch.startCoord.copy(t),Stretch.corner=i},onMove:function(e){var[t,i]=pf.viewport();let s=(h.parentModal?h.parentModal.handler:h.parentDisplaycell).coord;var l=Stretch.startCoord;let r,a,n,o;switch(Stretch.corner){case"UL":n=l.width-e.x,n<h.minWidth&&(e.x-=h.minWidth-n,n=h.minWidth),o=l.height-e.y,o<h.minHeight&&(e.y-=h.minHeight-o,o=h.minHeight),r=l.x+e.x,r<0&&(n+=r,r=0),a=l.y+e.y,a<0&&(o+=a,a=0);break;case"UR":r=l.x,n=l.width+e.x,n<h.minWidth&&(e.x-=h.minWidth-n,n=h.minWidth),r+n>t&&(n+=t-(r+n)),o=l.height-e.y,o<h.minHeight&&(e.y-=h.minHeight-o,o=h.minHeight),a=l.y+e.y,a<0&&(o+=a,a=0);break;case"LL":n=l.width-e.x,n<h.minWidth&&(e.x-=h.minWidth-n,n=h.minWidth),r=l.x+e.x,r<0&&(n+=r,r=0),a=l.y,o=l.height+e.y,o<h.minHeight&&(e.y-=h.minHeight-o,o=h.minHeight),o+a>i&&(o=i-a);break;case"LR":r=l.x,a=l.y,n=l.width+e.x,n<h.minWidth&&(n=h.maxWidth),n+r>t&&(n=t-r),o=l.height+e.y,o<h.minHeight&&(o=h.maxHeight),o+a>i&&(o=i-a)}s.assign(r,a,n,o),Handler.update()},onUp:this.onUpCallBack}})}render(e,t,i,s){var l;s||(l=this.parentDisplaycell.coord,this.UL.coord.assign(l.x,l.y,this.pxSize,this.pxSize,l.within.x,l.within.y,l.within.width,l.within.height,l.zindex+Handler.zindexIncrement),this.UR.coord.assign(l.x+l.width-this.pxSize+1,l.y,this.pxSize,this.pxSize,l.within.x,l.within.y,l.within.width,l.within.height,l.zindex+Handler.zindexIncrement),this.LL.coord.assign(l.x,l.y+l.height-this.pxSize+1,this.pxSize,this.pxSize,l.within.x,l.within.y,l.within.width,l.within.height,l.zindex+Handler.zindexIncrement),this.LR.coord.assign(l.x+l.width-this.pxSize+1,l.y+l.height-this.pxSize+1,this.pxSize,this.pxSize,l.within.x,l.within.y,l.within.width,l.within.height,l.zindex+Handler.zindexIncrement));var r=[this.UL,this.UR,this.LL,this.LR];for(let e=0;e<r.length;e++)Handler.renderDisplayCell(r[e],void 0,void 0,s)}}function stretch(...e){var t=new Overlay("Stretch",...e),e=t.returnObj;let i=e.parentDisplaycell;return i.addOverlay(t),e.parentModal||i}Stretch.labelNo=0,Stretch.instances=[],Stretch.activeInstances=[],Stretch.defaults={pxSize:10,minWidth:200,minHeight:200,onUpCallBack:function(){}},Stretch.argMap={string:["label"],Modal:["parentModal"]},Stretch.NWcss=new Css("NWcss","cursor: nw-resize;"),Stretch.NEcss=new Css("NEcss","cursor: ne-resize;"),Stretch.startCoord=new Coord,Overlay.classes.Stretch=Stretch;class TreeNode extends Base{constructor(...e){super(),this.collapsed=!1,this.nodeCellArray=[],this.buildBase(...e),this.labelCell.htmlBlock&&(this.labelCell.htmlBlock.hideWidth=this.labelCell.coord.hideWidth=!0),this.labelCell&&!this.label&&(this.label=this.labelCell.label)}visibleChildren(e=0){if(!this.collapsed&&this.children)for(var t of this.children)e+=t.visibleChildren(1);return e}addDisplayCells(e=[],t=!0){if(t||e.push(this.horizontalDisplayCell),!this.collapsed&&this.children)for(var i of this.children)e=i.addDisplayCells(e,!1);return e}}function T(...e){return new TreeNode(...e)}TreeNode.instances=[],TreeNode.activeInstances=[],TreeNode.defaults={},TreeNode.argMap={DisplayCell:["labelCell"],string:["label"],Array:["children"],boolean:["collapsed"]};class Tree extends Base{constructor(...e){if(super(),this.css="",this.buildBase(...e),this.parentDisplayCell||(this.parentDisplayCell=new DisplayCell(`TreeRoot_${this.label}`)),"Css"in this.retArgs)for(var t of this.retArgs.Css)this.css=(this.css+" "+t.classname).trim();"string"in this.retArgs&&1<this.retArgs.string.length&&(this.css+=" "+this.retArgs.string.splice(1).join(" "));var i=v(`${this.label}_rootV`,this.parentDisplayCell.dim,this.margin,this.margin),e=i.displaygroup.cellArray;this.parentDisplayCell.displaygroup=new DisplayGroup(`${this.label}_rootH`,i),this.t_instance&&!this.rootTreeNode&&(this.rootTreeNode=Tree.autoLabelTreenodes(this.label,this.t_instance)),this.rootTreeNode||(this.rootTreeNode=Tree.defaultObj),this.parentDisplayCell.preRenderCallback=function(t,e,i,s){if(!Handler.firstRun){var l,r;let e=0;for(r of document.querySelectorAll("[treenode]"))(l=(l=r.getBoundingClientRect()).x+l.width)>e&&(e=l);var a=t.coord.x+t.coord.width,n=t.coord.x;t.displaygroup.cellArray[0].dim=`${a>e?a-n:e-n}px`}},Tree.makeLabel(this),this.buildTreeNode(this.rootTreeNode,e)}drawSVG(e){var t=this.collapsePad,i=(this.cellHeight-this.collapseSize)/2+this.collapsePad,s=this.collapseSize-t,l=i+this.collapseSize-2*this.collapsePad,r=this.collapseSize/2,a=this.cellHeight/2,n=this.SVGColor;return`<svg height="${this.cellHeight}" width="${this.collapseSize}">`+(e?`<polygon points="${t},${i} ${s},${a} ${t},${l} ${t},${i}"`:`<polygon points="${t},${i} ${s},${i} ${r},${l} ${t},${i}"`)+`style="fill:${n};stroke:${n};stroke-width:1" />
            </svg>`}toggleCollapse(e,t,i){e.collapsed=!e.collapsed,e.horizontalDisplayCell.displaygroup.cellArray[1].htmlBlock.innerHTML=this.drawSVG(e.collapsed);let s=this.parentDisplayCell.displaygroup.cellArray[0].displaygroup.cellArray;var l=s.indexOf(e.horizontalDisplayCell);if(e.collapsed){for(var r of e.nodeCellArray)Handler.renderDisplayCell(r,void 0,void 0,!0);e.collapsed=!e.collapsed;var a=e.visibleChildren();e.collapsed=!e.collapsed,s.splice(l+1,a)}else s.splice(l+1,0,...e.addDisplayCells());Handler.update()}buildTreeNode(t=this.rootTreeNode,e,i=this.startIndent){let s=this;var l=!!t.children&&!!t.children.length;if(t.labelCell.htmlBlock.attributes.treenode="",!t.labelCell.htmlBlock.css&&this.css.trim()&&(t.labelCell.htmlBlock.css=this.css.trim()),!t.labelCell.htmlBlock.events&&this.events&&(t.labelCell.htmlBlock.events=this.events),t.horizontalDisplayCell=h(I(t.label+"_spacer","",`${i}px`),I(t.label+"_svg",l?this.drawSVG(t.collapsed):"",`${this.collapseSize}px`,events({onclick:function(e){e.preventDefault(),s.toggleCollapse(t,e,this)},onmousedown:function(e){window.addEventListener("selectstart",Drag.disableSelect)},onmouseup:function(e){window.removeEventListener("selectstart",Drag.disableSelect)}})),t.labelCell,`${this.cellHeight}px`),e.push(t.horizontalDisplayCell),t.children){for(var r of t.children)this.buildTreeNode(r,t.nodeCellArray,i+this.indent);t.collapsed||DisplayCell.concatArray(e,t.nodeCellArray)}}render(e){}static autoLabelTreenodes(e,t){return Tree.autoLabel(t,e),Tree.makeTreeNodes(t)}static autoLabel(e,t){if(e.label=t,e.TreeNodeArguments[0].label=t,1<e.TreeNodeArguments.length){var i=e.TreeNodeArguments[1];for(let e=0;e<i.length;e++){var s=i[e];Tree.autoLabel(s,t+"_"+e)}}}static makeTreeNodes(e){let t=[],i;var s=e.TreeNodeArguments[0];if(1<e.TreeNodeArguments.length){for(const l of e.TreeNodeArguments[1])t.push(Tree.makeTreeNodes(l));i=T(e.label,I(s.label,...s.Arguments),t)}else i=T(e.label,I(s.label,...s.Arguments));return i}static t(...e){return new t_(...e)}static i(...e){return new i_(...e)}static onclick(e){var t=this;let i=t.getAttribute("pagebutton");var s=i.split("|"),l=s[0],s=s[1];Pages.setPage(l,parseInt(s)),HtmlBlock.byLabel(t.id).events&&HtmlBlock.byLabel(t.id).events.actions.onclick&&HtmlBlock.byLabel(t.id).events.actions.onclick.bind(t)(e)}}function tree(...e){e=new Overlay("Tree",...e);let t=e.returnObj.parentDisplayCell;return t.addOverlay(e),t}function TI(...t){var i;let s,e;for(let e=0;e<t.length;e++)i=t[e],pf.isArray(i)&&(s=i,t.splice(e,1),--e);var l=Tree.i(...t);return e=s?Tree.t(l,s):Tree.t(l),e}Tree.instances=[],Tree.activeInstances=[],Tree.defaultObj=T("Tree",I("Tree_TopDisplay","Top Display"),[T("Tree_child1",I("Tree_Child1ofTop","Child1ofTop"),[T("Tree_child1_1",I("Tree_Child1ofChild1","Child1ofChild1")),T("Tree_child1_2",I("Tree_Child2ofChild1","Child2ofChild1"))]),T("Tree_child2",I("Tree_Child2ofTop","Child2ofTop"))]),Tree.defaults={cellHeight:20,SVGColor:"white",startIndent:0,indent:10,collapsePad:4,collapseSize:16,margin:2},Tree.argMap={string:["label"],number:["cellHeight","margin"],TreeNode:["rootTreeNode"],DisplayCell:["parentDisplayCell"],Events:["events"],t_:["t_instance"]},Overlay.classes.Tree=Tree;class i_{constructor(...e){this.Arguments=e}}class t_{constructor(...e){this.TreeNodeArguments=e}}class Observe extends Base{constructor(...e){super(),this.buildBase(...e);let n=this,t=Handler.byLabel(n.label);t.coord||(t.coord=new Coord),-1==Handler.activeInstances.indexOf(t)&&Handler.activeInstances.push(t),this.parentDisplayCell.htmlBlock.el.onscroll=function(e){Observe.onScroll(e)},t.controlledBySomething=!0,this.parentDisplayCell.postRenderCallback||(this.parentDisplayCell.postRenderCallback=FunctionStack.function(this.parentDisplayCell.label)),Observe.makeLabel(this),FunctionStack.push(this.parentDisplayCell.label,function(e,t=0,i,s){var l=e.htmlBlock.el,r=e.coord;let a=Handler.byLabel(n.label).coord;e=n.el.getBoundingClientRect();a.x=e.x,a.y=e.y,a.width=e.width,a.height=e.height,a.within.x=r.x,a.within.y=r.y,a.within.width=r.width-(l.scrollHeight>l.clientHeight?Observe.Os_ScrollbarSize:0),a.within.height=r.height-(l.scrollWidth>l.clientWidth?Observe.Os_ScrollbarSize:0)}),Handler.update()}static derender(t){for(let e=0;e<Observe.instances.length;e++){var i,s,l=Observe.instances[e];l.parentDisplayCell==t&&(i=Handler.byLabel(l.label),-1<(s=Handler.activeInstances.indexOf(i))&&Handler.activeInstances.splice(s,1),l=Observe.instances.indexOf(l),Observe.instances.splice(l,1),Handler.renderDisplayCell(i.rootCell,void 0,void 0,!0),--e)}FunctionStack.pop(t.label)}static onScroll(e){for(let e=0;e<Observe.instances.length;e++){const t=Observe.instances[e];t.parentDisplayCell.postRenderCallback(t.parentDisplayCell),Handler.update()}}static update(){var t=document.querySelectorAll("[parentof]");let i=[];for(let e=0;e<t.length;e++){var s=t[e],l=pf.getAttribs(s).parentof,r=Handler.byLabel(l);if(r&&(i.push(l),!Observe.byLabel(l))){let e=s.parentElement,t;for(;e&&!t;)t=DisplayCell.byLabel(e.id),e=e.parentElement;new Observe(l,s,t)}}}}Observe.instances=[],Observe.activeInstances=[],Observe.defaults={},Observe.argMap={string:["label"],HTMLDivElement:["el"],DisplayCell:["parentDisplayCell"]},Observe.Os_ScrollbarSize=15;class Dockable extends Base{constructor(...e){super(),this.buildBase(...e),this.rootDisplayCell&&(this.displaygroup=this.rootDisplayCell.displaygroup),Dockable.makeLabel(this),this.dummy=I(`${this.label}_DockableDummy`)}render(e,t,i,s){if(ToolBar.isMoving&&!ToolBar.activeInstace.isDocked){let i=Dockable.activeToolbar=ToolBar.activeInstace,s=this.displaygroup.cellArray;if(!this.dropZones){this.dropZones=[];for(let t=0;t<s.length;t++){var l=s[t];let e=new Coord;e.copy(l.coord),e.assign(void 0,void 0,void 0,i.sizePx),this.dropZones.push(e)}var r=s[s.length-1];let e=new Coord;e.copy(r.coord),e.assign(void 0,r.coord.height-i.sizePx,void 0,i.sizePx),this.dropZones.push(e)}for(let e=0;e<this.dropZones.length;e++){var a=this.dropZones[e];i.rootDisplayCell.coord.isCoordCompletelyOutside(a)?e==Dockable.open&&(Dockable.open=void 0,s.splice(e,1)):null==Dockable.open&&(Dockable.open=e,this.dummy.dim=`${i.sizePx}px`,s.splice(e,0,this.dummy))}}else if(this.dropZones){if(null!=Dockable.open){let e=Dockable.activeToolbar;this.displaygroup.cellArray[Dockable.open]=e.rootDisplayCell,Dockable.open=void 0,e.isDocked=!0,e.modal.hide(),Handler.update()}this.dropZones=void 0}}}function dockable(...e){e=new Overlay("Dockable",...e);let t=e.returnObj.rootDisplayCell;return t.addOverlay(e),t}Dockable.labelNo=0,Dockable.instances=[],Dockable.activeInstances=[],Dockable.defaults={type:"All"},Dockable.argMap={string:["label","type"],DisplayCell:["rootDisplayCell"]},Overlay.classes.Dockable=Dockable;class ToolBar extends Base{constructor(...e){if(super(),this.buildBase(...e),ToolBar.makeLabel(this),this.spacer=I(`${this.label}_toolbar_spacer`),"DisplayCell"in this.retArgs){this.displaycells=this.retArgs.DisplayCell;for(let t=0;t<this.displaycells.length;t++){let e=this.displaycells[t];e.dim||(e.dim=`${this.sizePx}px`)}}this.rootDisplayCell||this.build(),this.makeModal()}static startMoveToolbar(e,t){Modal.movingInstace=e.modal}static moveToolbar(e,t,i){e.rootDisplayCell.coord.setOffset(i.x,i.y),(Math.abs(i.x)>ToolBar.triggerUndockDistance||Math.abs(i.y)>ToolBar.triggerUndockDistance)&&(e.rootDisplayCell.coord.setOffset(),ToolBar.undock(e,t,i)),Handler.update()}static undock(e,t,i){var s=e.parentDisplayGroup.cellArray.indexOf(e.rootDisplayCell);-1<s&&e.parentDisplayGroup.cellArray.splice(s,1),e.isDocked=!1,Modal.x=e.rootDisplayCell.coord.x,Modal.y=e.rootDisplayCell.coord.y;var[l,r]=e.setModalSize(),s=e.rootDisplayCell.coord.x+i.x,i=e.rootDisplayCell.coord.y+i.y;e.modal.setSize(s,i,l,r),e.modal.show()}build(){let t=this;var e=I(`${this.label}_checker`,ToolBar.llm_checker,"10px",events({ondrag:{onDown:function(){return ToolBar.isMoving=!0,(ToolBar.activeInstace=t).isDocked?ToolBar.startMoveToolbar(t,t.modal.handler):Modal.startMoveModal(t.modal.handler)},onMove:function(e){return t.isDocked?ToolBar.moveToolbar(t,t.modal.handler,e):Modal.moveModal(t.modal.handler,e)},onUp:function(e){ToolBar.isMoving=!1,ToolBar.activeInstace=void 0,Modal.movingInstace=void 0,t.isDocked&&t.rootDisplayCell.coord.setOffset(),Handler.update()}}}));this.hBar=h(`${this.label}_hBar`,`${this.sizePx}px`),this.vBar=v(`${this.label}_hBar`,`${this.sizePx}px`),this.displaycells.unshift(e),this.hBar.displaygroup.cellArray=this.vBar.displaygroup.cellArray=this.displaycells,this.rootDisplayCell=P(`${this.label}_toolbar_Pages`,`${this.sizePx}px`,this.hBar,this.vBar,this.sizeFunction)}makeModal(){this.modal=new Modal(`${this.label}_modal`,{fullCell:this.rootDisplayCell},...this.setModalSize())}setModalSize(){return[this.isHor?this.displaycells.length*this.sizePx:this.sizePx,this.isHor?this.sizePx:this.displaycells.length*this.sizePx]}sizeFunction(e){return 0}render(e,t,i,s){this.parentDisplayGroup||(this.parentDisplayGroup=t)}}function tool_bar(...e){e=new Overlay("ToolBar",...e);let t=e.returnObj.rootDisplayCell;return t.addOverlay(e),t}ToolBar.labelNo=0,ToolBar.instances=[],ToolBar.activeInstances=[],ToolBar.llm_checker=css("llm_checker",`cursor:pointer;
    --checkerSize: 2px; /* edit me */
    background-image:
      linear-gradient(45deg, lightgrey 25%, transparent 25%), 
      linear-gradient(135deg, lightgrey 25%, transparent 25%),
      linear-gradient(45deg, transparent 75%, lightgrey 75%),
      linear-gradient(135deg, transparent 75%, lightgrey 75%);
    background-size: 
      calc(2 * var(--checkerSize)) 
      calc(2 * var(--checkerSize));
    background-position: 
      0 0, 
      var(--checkerSize) 0, 
      var(--checkerSize) calc(-1 * var(--checkerSize)), 
      0px var(--checkerSize);
    /* for fun */
    transition-property: background-position, background-size;
    transition-duration: 2s;`),ToolBar.defaults={sizePx:25,isDocked:!0,isHor:!0,type:"All"},ToolBar.argMap={string:["label","type"],number:["sizePx"]},ToolBar.triggerUndockDistance=15,ToolBar.isMoving=!1,Overlay.classes.ToolBar=ToolBar;